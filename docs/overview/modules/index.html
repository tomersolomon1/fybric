<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><title>Modules - The Mesh for Data</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=https://ibm.github.io/the-mesh-for-data/favicon.png><link rel=stylesheet href=/the-mesh-for-data/css/style.min.3dea6367d70c56e79acec88bd5217c58299cb81f7dd3f7a663517f3f971ab627.css></head><body class="page page-default-single"><div id=main-menu-mobile class=main-menu-mobile><ul><li class=menu-item-home><a href=/the-mesh-for-data/><span>Home</span></a></li><li class=menu-item-docs><a href=/the-mesh-for-data/docs/><span>Docs</span></a></li><li class=menu-item-contribute><a href=/the-mesh-for-data/contribute/><span>Contribute</span></a></li></ul></div><div class=wrapper><div class=header><div class=container><div class=logo><a href=https://ibm.github.io/the-mesh-for-data/><img alt=Logo src=/the-mesh-for-data/images/logo.svg></a></div><div class=logo-mobile><a href=https://ibm.github.io/the-mesh-for-data/><img alt=Logo src=/the-mesh-for-data/images/logo.svg></a></div><div id=main-menu class=main-menu><ul><li class=menu-item-home><a href=/the-mesh-for-data/><span>Home</span></a></li><li class=menu-item-docs><a href=/the-mesh-for-data/docs/><span>Docs</span></a></li><li class=menu-item-contribute><a href=/the-mesh-for-data/contribute/><span>Contribute</span></a></li></ul></div><button id=toggle-main-menu-mobile class="hamburger hamburger--slider" type=button>
<span class=hamburger-box><span class=hamburger-inner></span></span></button></div></div><div class="container pt-2 pt-md-6 pb-3 pb-md-6"><div class=row><div class="col-12 col-md-3 mb-3"><div class="d-none d-lg-block"><nav id=sidebar aria-label="Section Navigation"><div class=directory><div class=card><button class="header dynamic" id=card4 aria-controls=card4-body>Overview</button><div class="body default" aria-labelledby=card4 role=region id=card4-body><ul role=tree aria-expanded=true class=leaf-section aria-labelledby=card4><li role=none><a role=treeitem title=() href=https://ibm.github.io/the-mesh-for-data/docs/overview/what-is/>Introduction</a></li><li role=none><a role=treeitem title=() href=https://ibm.github.io/the-mesh-for-data/docs/overview/architecture/>Architecture</a></li><li role=none><a role=treeitem title=() href=https://ibm.github.io/the-mesh-for-data/docs/overview/connectors/>Connectors</a></li><li role=none><span role=treeitem class=current title=()>Modules</span></li></ul></div></div><div class=card><button class="header dynamic" id=card8 aria-controls=card8-body>Setup</button><div class=body aria-labelledby=card8 role=region id=card8-body><ul role=tree aria-expanded=true class=leaf-section aria-labelledby=card8><li role=none><a role=treeitem href=https://ibm.github.io/the-mesh-for-data/docs/setup/quickstart/>Quick Start</a></li><li role=none><a role=treeitem href=https://ibm.github.io/the-mesh-for-data/docs/setup/install/>Install</a></li><li role=none><a role=treeitem href=https://ibm.github.io/the-mesh-for-data/docs/setup/egeria/install/>ODPi Egeria Install</a></li></ul></div></div><div class=card><button class="header dynamic" id=card13 aria-controls=card13-body>Usage</button><div class=body aria-labelledby=card13 role=region id=card13-body><ul role=tree aria-expanded=true class=leaf-section aria-labelledby=card13><li role=none><a role=treeitem href=https://ibm.github.io/the-mesh-for-data/docs/usage/notebook-sample/>Notebook sample</a></li><li role=none><a role=treeitem href=https://ibm.github.io/the-mesh-for-data/docs/usage/opa/update_policies/>Using OPA</a></li></ul></div></div><div class=card><button class="header dynamic" id=card16 title="Detailed authoritative reference material such as command-line options, configuration options, and API calling parameters." aria-controls=card16-body>Reference</button><div class=body aria-labelledby=card16 role=region id=card16-body><ul role=tree aria-expanded=true aria-labelledby=card16><li role=none><a role=treeitem title=() href=https://ibm.github.io/the-mesh-for-data/docs/reference/roadmap/>Roadmap</a></li><li role=treeitem aria-label="API Reference"><button aria-hidden=true></button><a title=() href=https://ibm.github.io/the-mesh-for-data/docs/reference/api/>API Reference</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem href=https://ibm.github.io/the-mesh-for-data/docs/reference/api/generated/connectors.pb/>connectors</a></li><li role=none><a role=treeitem href=https://ibm.github.io/the-mesh-for-data/docs/reference/api/generated/app/>app.m4d.ibm.com</a></li><li role=none><a role=treeitem href=https://ibm.github.io/the-mesh-for-data/docs/reference/api/generated/motion/>motion.m4d.ibm.com</a></li></ul></li><li role=treeitem aria-label=Components><button aria-hidden=true></button><a title=() href=https://ibm.github.io/the-mesh-for-data/docs/reference/components/>Components</a><ul role=group aria-expanded=false class=leaf-section><li role=none><a role=treeitem title=() href=https://ibm.github.io/the-mesh-for-data/docs/reference/components/ddc/>Data Distribution Controller v1.0</a></li></ul></li></ul></div></div></div></nav></div></div><div class="col-12 col-md-9"><nav aria-label=Breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=https://ibm.github.io/the-mesh-for-data/>The Mesh for Data</a></li><li class=breadcrumb-item><a href=https://ibm.github.io/the-mesh-for-data/docs/>Docs</a></li><li class=breadcrumb-item><a href=https://ibm.github.io/the-mesh-for-data/docs/overview/>Overview</a></li><li class=breadcrumb-item>Modules</li></ol></nav><h1 class=title>Modules</h1><div class="content anchor-link-enabled"><p>The project currently has two extension mechanisms, namely connectors and modules.
Here we describe what modules are and what default modules are installed using the default The Mesh for Data instsallation.</p><h1 id=what-are-modules>What are modules?</h1><p>At runtime, the control plane builds a blueprint for each application. The blueprint includes services, jobs, and configurations that are injected into the data path by the control plane to fulfill governance requirements and application requirements.</p><p>Modules are the way to pack such injectable services, jobs, and configurations and make them available to the control plane.</p><h1 id=concept>Concept</h1><p>For the control plane to build a blueprint that includes modules, the control plane needs a catalog of all the modules available for its use.  Therefore, the control plane is attached with a <strong>module repository</strong> listing all registered modules. </p><p>For each module, the control plane needs <strong>module details</strong> describing the capabilities of the module (read, write, copy, transforms, etc.). This is needed so the control plane could pick the set of modules that can be used together in the same blueprint and fulfill all application and governance requirements. </p><p>For any module picked by the control plane to be part of a blueprint, the control plane needs to be able to install/remove/upgrade an instance of the module. For example, if it&rsquo;s a service then the control plane needs to deploy and configure the service. This is done by installing the deployable <strong>module package</strong>.</p><p>Once deployed, we have an instance of the module&rsquo;s resources deployed to the cluster. Depending on the type of module, this can eventually be some code running in Kubernetes pods. This is the <strong>module code</strong>.</p><p>This document describes how The Mesh for Data currently implements this concept using <code>M4DModule</code> CRD and Helm as well as listing requirements from the module code.</p><h1 id=m4dmodule>M4DModule</h1><p>A <code>M4DModule</code> CRD describes a single module:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=k>apiVersion</span><span class=p>:</span><span class=w> </span>app.m4d.ibm.com/v1alpha1<span class=w>
</span><span class=w></span><span class=k>kind</span><span class=p>:</span><span class=w> </span>M4DModule<span class=w>
</span><span class=w></span><span class=k>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=k>name</span><span class=p>:</span><span class=w> </span>module<span class=w> </span>name<span class=w>
</span><span class=w>  </span><span class=k>namespace</span><span class=p>:</span><span class=w> </span>m4d-system<span class=w>  </span><span class=c># control plane namespace</span><span class=w>
</span><span class=w>  </span><span class=k>labels</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=k>name</span><span class=p>:</span><span class=w> </span>module<span class=w> </span>name<span class=w>
</span><span class=w>    </span><span class=k>version</span><span class=p>:</span><span class=w> </span><span class=m>1.0.0</span><span class=w>  </span><span class=c># semantic version </span><span class=w>
</span><span class=w></span><span class=k>spec</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=k>chart</span><span class=p>:</span><span class=w> </span>helm<span class=w> </span>chart<span class=w> </span>reference<span class=w> </span><span class=c># e.g. docker.io/username/chartname:chartversion</span><span class=w>
</span><span class=w>  </span><span class=k>type</span><span class=p>:</span><span class=w> </span>job/service/configuration<span class=w> </span><span class=c># one of</span><span class=w>
</span><span class=w>  </span><span class=k>dependencies</span><span class=p>:</span><span class=w>
</span><span class=w>    </span>- <span class=k>type</span><span class=p>:</span><span class=w> </span>module<span class=w> </span><span class=c># currently must be &#34;module&#34;</span><span class=w>
</span><span class=w>      </span><span class=k>name</span><span class=p>:</span><span class=w> </span>module<span class=w> </span>name<span class=w> </span><span class=c># the `metadata.name` field of another applied M4DModule</span><span class=w>
</span><span class=w>  </span><span class=k>flows</span><span class=p>:</span><span class=w>
</span><span class=w>    </span>- read<span class=w>  </span><span class=c># optional</span><span class=w>
</span><span class=w>    </span>- write<span class=w> </span><span class=c># optional</span><span class=w>
</span><span class=w>    </span>- copy<span class=w>  </span><span class=c># optional</span><span class=w>
</span><span class=w>  </span><span class=k>capabilities</span><span class=p>:</span><span class=w>
</span><span class=w>    </span>...<span class=w> </span><span class=c># omitted for brevity</span><span class=w>
</span></code></pre></div><p>An administrator registers a module with a control plane by applying a <code>M4DModule</code> resource in the namespace of the control plane (i.e., <code>m4d-system</code>). Hence, the module repository is the set of all <code>M4DModule</code> resources in that namespace.</p><p>The <code>spec.chart</code> field contains a reference to a Helm chart stored in an OCI image registry. This is similar to how a Kubernetes <code>Pod</code> contains a reference to a container image. The Helm chart is the module package that the control plane can dynamically install/remove/upgrade as needed as part of a blueprint. See <a href=#module-helm-chart>Module Helm chart</a> for details.</p><p>The reminder of the <code>spec</code> field lists the module details:</p><ul><li><strong><code>type</code></strong>: specifies whether the module package deploys a job, a service, or just configuration. This is necessary for understanding what to expect from the status of the deployed module. Note that <code>service</code> is not necessarily a Kubernetes <code>Service</code> but rather sanything that runs without completion (e.g., a Kubernetes <code>Deployment</code> or <code>StatefulSet</code>).</li><li><strong><code>dependencies</code></strong>: lists the requirements for using this module in a blueprint. Currently only a dependency on another modules is supported. When another module is listed as a dependency, it means that it must be part of the same blueprint. For modules of type <code>configuration</code> the first dependency indicates the parent module that the configuration applies to.</li><li><strong><code>flows</code></strong>: The Mesh for Data currently supports three data flows: read for enabling an application to read data, write for enabling an application to write data, and copy for performing an implicit data copy on behalf of the application. A module is associated with one or more data flow based on its functionality.</li><li><strong><code>capabilities</code></strong>: lists the capabilities of the module as described next in <a href=#module-capabilities>Module capabilities</a></li></ul><h1 id=module-capabilities>Module capabilities</h1><p>The <code>spec.capabilities</code> field is defined as follows:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=k>capabilities</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=k>api</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=k>protocol</span><span class=p>:</span><span class=w> </span>protocol<span class=w>
</span><span class=w>    </span><span class=k>dataformat</span><span class=p>:</span><span class=w> </span>format<span class=w> </span><span class=c># optional</span><span class=w>
</span><span class=w>  </span><span class=k>supportedInterfaces</span><span class=p>:</span><span class=w>
</span><span class=w>    </span>- <span class=k>flow</span><span class=p>:</span><span class=w> </span>read/write/copy<span class=w>
</span><span class=w>      </span><span class=k>source</span><span class=p>:</span><span class=w> </span><span class=c>#optional</span><span class=w>
</span><span class=w>        </span><span class=k>protocol</span><span class=p>:</span><span class=w> </span>protocol<span class=w>
</span><span class=w>        </span><span class=k>dataformat</span><span class=p>:</span><span class=w> </span>file<span class=w> </span>format<span class=w>
</span><span class=w>      </span><span class=k>sink</span><span class=p>:</span><span class=w> </span><span class=c>#optional</span><span class=w>
</span><span class=w>        </span><span class=k>protocol</span><span class=p>:</span><span class=w> </span>protocol<span class=w>
</span><span class=w>        </span><span class=k>dataformat</span><span class=p>:</span><span class=w> </span>file<span class=w> </span>format<span class=w>
</span><span class=w>  </span><span class=k>actions</span><span class=p>:</span><span class=w>
</span><span class=w>    </span>- <span class=k>id</span><span class=p>:</span><span class=w> </span>enforcement<span class=w> </span>action<span class=w> </span>identifier<span class=w> 
</span><span class=w>      </span>level<span class=p>:</span><span class=w> </span>dataset/column<span class=w>
</span></code></pre></div><ul><li><strong><code>api</code></strong> specifies what client-facing API the module exposes to a caller that invokes read or write commands</li><li><strong><code>supportedInterfaces</code></strong> lists the supported data services that the module can read data from and write data to</li><li><strong><code>actions</code></strong> lists the enforcement actions (e.g., transforms) supported by the module. The actions are taken from a defined <a href=about:blank>Enforcement Actions Taxonomy</a></li></ul><p>A <code>protocol</code> field can take a value such as <code>kafka</code>, <code>s3</code>, <code>jdbc-db2</code>, <code>m4d-arrow-flight</code>, etc.</p><p>A <code>format</code> field can take a value such as <code>avro</code>, <code>parquet</code>, <code>json</code>, or <code>csv</code>.</p><p>Note that a module that targets copy flows will omit the <code>api</code> field and contain just <code>source</code> and <code>sink</code>, a module that only supports reading data assets will omit the <code>sink</code> field and only contain <code>api</code> and <code>source</code>, a module that does not perform any enforcement actions can omit the <code>actions</code> field, etc.</p><h1 id=module-helm-chart>Module Helm chart</h1><p>Module is packed as a Helm chart to be installed dynamically by the control plane whenever needed. The Helm chart must be stored in an <a href=https://helm.sh/docs/topics/registries/>OCI registry</a> capable of holding Helm charts. The project provides tooling for pushing modules to such Helm repositories.</p><p>Since the Helm package is installed by the control plane, it can&rsquo;t assume that arbitrary values will be passed. Instead, the project defines the exact values that are available to the control plane and that the module <em>should</em> accept as template values. The name, namespace, labels and service account must always be templated.</p><table><thead><tr><th>Context</th><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>Root</td><td>name</td><td>String</td><td>Instance name</td></tr><tr><td>Root</td><td>namespace</td><td>String</td><td>Instance namespace</td></tr><tr><td>Root</td><td>labels</td><td>String[]</td><td>Instance labels</td></tr><tr><td>Root</td><td>serviceAccount</td><td>String</td><td>Service account</td></tr><tr><td>Root</td><td>arguments</td><td>Arguments</td><td>Arguments</td></tr><tr><td>Arguments</td><td>flow</td><td>String</td><td>copy, read or write</td></tr><tr><td>Arguments</td><td>copy</td><td>Copy</td><td>Copy arguments</td></tr><tr><td>Copy</td><td>source</td><td>DataStore</td><td>Copy source</td></tr><tr><td>Copy</td><td>destination</td><td>DataStore</td><td>Copy sink</td></tr><tr><td>Copy</td><td>transformations</td><td>EnforcementAction[]</td><td>Actions on copy</td></tr><tr><td>Arguments</td><td>read</td><td>Read[]</td><td>Read arguments</td></tr><tr><td>Read</td><td>source</td><td>DataStore</td><td>Read datastore</td></tr><tr><td>Read</td><td>transformations</td><td>EnforcementAction[]</td><td>Actions for read item</td></tr><tr><td>Arguments</td><td>write</td><td>Write[]</td><td>Write arguments</td></tr><tr><td>Write</td><td>destination</td><td>DataStore</td><td>Write datastore</td></tr><tr><td>Write</td><td>transformations</td><td>EnforcementAction[]</td><td>Actions on write item</td></tr></tbody></table></div></div></div></div></div></div><div class=sub-footer><div class=container><div class=row><div class=col-12><div class=sub-footer-inner><ul><li class=fineprint><a href=https://ibm.github.io/the-mesh-for-data/legal>fine print</a></li></ul></div></div></div></div></div><script type=text/javascript src=/the-mesh-for-data/js/scripts.min.743d9793278e564da4ce594a32a52b65cbd1df69adbfc11858d0093e9a230182.js></script></body></html>